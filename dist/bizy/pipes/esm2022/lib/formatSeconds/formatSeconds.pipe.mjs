import { Inject, Pipe } from '@angular/core';
import { BIZY_FORMAT_SECONDS_FORMAT, BIZY_FORMAT_SECONDS_LANGUAGE } from './formatSeconds.types';
import { BizyFormatSecondsService } from './formatSeconds.service';
import * as i0 from "@angular/core";
import * as i1 from "./formatSeconds.service";
export class BizyFormatSecondsPipe {
    bizyFormatSecondsService;
    constructor(bizyFormatSecondsService) {
        this.bizyFormatSecondsService = bizyFormatSecondsService;
    }
    transform(seconds, options) {
        if (!seconds) {
            return '00:00:00';
        }
        const regex = /^-?\d+(\.\d+)?$/;
        const isNumber = regex.test(String(seconds).toLowerCase());
        if (!isNumber || seconds <= 0) {
            return '00:00:00';
        }
        const defaultOptions = this.bizyFormatSecondsService.getOptions();
        const language = options?.language ?? defaultOptions.language;
        const format = options?.format ?? defaultOptions.format;
        const DAY = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Día' : 'Day';
        const DAYS = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Días' : 'Days';
        const MONTH = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Mes' : 'Month';
        const MONTHS = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Meses' : 'Months';
        const YEAR = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Año' : 'Year';
        const YEARS = language === BIZY_FORMAT_SECONDS_LANGUAGE.SPANISH ? 'Años' : 'Years';
        let _seconds = Number(seconds);
        const SECONDS_IN_YEAR = 365.25 * 24 * 3600;
        const SECONDS_IN_MONTH = 30.44 * 24 * 3600;
        const SECONDS_IN_DAY = 24 * 3600;
        const SECONDS_IN_HOUR = 3600;
        const SECONDS_IN_MINUTE = 60;
        if (format === BIZY_FORMAT_SECONDS_FORMAT.DATE_TIME) {
            const years = Math.floor(_seconds / SECONDS_IN_YEAR);
            _seconds %= SECONDS_IN_YEAR;
            const months = Math.floor(_seconds / SECONDS_IN_MONTH);
            _seconds %= SECONDS_IN_MONTH;
            const days = Math.floor(_seconds / SECONDS_IN_DAY);
            _seconds %= SECONDS_IN_DAY;
            const hours = Math.floor(_seconds / SECONDS_IN_HOUR);
            _seconds %= SECONDS_IN_HOUR;
            const minutes = Math.floor(_seconds / SECONDS_IN_MINUTE);
            _seconds %= SECONDS_IN_MINUTE;
            const parts = [];
            if (years > 0) {
                parts.push(years + (years === 1 ? ` ${YEAR}` : ` ${YEARS}`));
            }
            if (months > 0) {
                parts.push(months + (months === 1 ? ` ${MONTH}` : ` ${MONTHS}`));
            }
            if (days > 0) {
                parts.push(days + (days === 1 ? ` ${DAY}` : ` ${DAYS}`));
            }
            parts.push(`${hours < 10 ? '0' + hours : hours}:${minutes < 10 ? '0' + minutes : minutes}:${_seconds < 10 ? '0' + Math.trunc(_seconds) : Math.trunc(_seconds)}`);
            return parts.join(' ');
        }
        else {
            const hours = Math.floor(_seconds / SECONDS_IN_HOUR);
            _seconds %= SECONDS_IN_HOUR;
            const minutes = Math.floor(_seconds / SECONDS_IN_MINUTE);
            _seconds %= SECONDS_IN_MINUTE;
            const parts = [];
            parts.push(`${hours < 10 ? '0' + hours : hours}:${minutes < 10 ? '0' + minutes : minutes}:${_seconds < 10 ? '0' + Math.trunc(_seconds) : Math.trunc(_seconds)}`);
            return parts.join(' ');
        }
    }
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: BizyFormatSecondsPipe, deps: [{ token: BizyFormatSecondsService }], target: i0.ɵɵFactoryTarget.Pipe });
    static ɵpipe = i0.ɵɵngDeclarePipe({ minVersion: "14.0.0", version: "16.2.12", ngImport: i0, type: BizyFormatSecondsPipe, name: "bizyFormatSeconds" });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "16.2.12", ngImport: i0, type: BizyFormatSecondsPipe, decorators: [{
            type: Pipe,
            args: [{
                    name: 'bizyFormatSeconds'
                }]
        }], ctorParameters: function () { return [{ type: i1.BizyFormatSecondsService, decorators: [{
                    type: Inject,
                    args: [BizyFormatSecondsService]
                }] }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0U2Vjb25kcy5waXBlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvcGlwZXMvc3JjL2xpYi9mb3JtYXRTZWNvbmRzL2Zvcm1hdFNlY29uZHMucGlwZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBaUIsTUFBTSxlQUFlLENBQUM7QUFDNUQsT0FBTyxFQUFFLDBCQUEwQixFQUFFLDRCQUE0QixFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDakcsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0seUJBQXlCLENBQUM7OztBQUtuRSxNQUFNLE9BQU8scUJBQXFCO0lBRXdCO0lBQXRELFlBQXNELHdCQUFrRDtRQUFsRCw2QkFBd0IsR0FBeEIsd0JBQXdCLENBQTBCO0lBQUcsQ0FBQztJQUU1RyxTQUFTLENBQUMsT0FBZSxFQUFFLE9BQXNGO1FBQzdHLElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDVixPQUFPLFVBQVUsQ0FBQztTQUNyQjtRQUVELE1BQU0sS0FBSyxHQUFHLGlCQUFpQixDQUFDO1FBQ2hDLE1BQU0sUUFBUSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLFFBQVEsSUFBSSxPQUFPLElBQUksQ0FBQyxFQUFFO1lBQzNCLE9BQU8sVUFBVSxDQUFDO1NBQ3JCO1FBRUQsTUFBTSxjQUFjLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLFVBQVUsRUFBRSxDQUFDO1FBRWxFLE1BQU0sUUFBUSxHQUFHLE9BQU8sRUFBRSxRQUFRLElBQUksY0FBYyxDQUFDLFFBQVEsQ0FBQztRQUM5RCxNQUFNLE1BQU0sR0FBRyxPQUFPLEVBQUUsTUFBTSxJQUFJLGNBQWMsQ0FBQyxNQUFNLENBQUM7UUFFeEQsTUFBTSxHQUFHLEdBQUcsUUFBUSxL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QUMsQ0FBQztZQUNqSyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7U0FDMUI7SUFDTCxDQUFDO3dHQXhFUSxxQkFBcUIsa0JBRVYsd0JBQXdCO3NHQUZuQyxxQkFBcUI7OzRGQUFyQixxQkFBcUI7a0JBSGpDLElBQUk7bUJBQUM7b0JBQ0osSUFBSSxFQUFFLG1CQUFtQjtpQkFDMUI7OzBCQUdnQixNQUFNOzJCQUFDLHdCQUF3QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdCwgUGlwZSwgUGlwZVRyYW5zZm9ybSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQklaWV9GT1JNQVRfU0VDT05EU19GT1JNQVQsIEJJWllfRk9STUFUX1NFQ09ORFNfTEFOR1VBR0UgfSBmcm9tICcuL2Zvcm1hdFNlY29uZHMudHlwZXMnO1xuaW1wb3J0IHsgQml6eUZvcm1hdFNlY29uZHNTZXJ2aWNlIH0gZnJvbSAnLi9mb3JtYXRTZWNvbmRzLnNlcnZpY2UnO1xuXG5AUGlwZSh7XG4gIG5hbWU6ICdiaXp5Rm9ybWF0U2Vjb25kcydcbn0pXG5leHBvcnQgY2xhc3MgQml6eUZvcm1hdFNlY29uZHNQaXBlIGltcGxlbWVudHMgUGlwZVRyYW5zZm9ybSB7XG5cbiAgICBjb25zdHJ1Y3RvcihASW5qZWN0KEJpenlGb3JtYXRTZWNvbmRzU2VydmljZSkgcHJpdmF0ZSBiaXp5Rm9ybWF0U2Vjb25kc1NlcnZpY2U6IEJpenlGb3JtYXRTZWNvbmRzU2VydmljZSkge31cblxuICAgIHRyYW5zZm9ybShzZWNvbmRzOiBudW1iZXIsIG9wdGlvbnM/OiB7Zm9ybWF0OiBCSVpZX0ZPUk1BVF9TRUNPTkRTX0ZPUk1BVCwgbGFuZ3VhZ2U6IEJJWllfRk9STUFUX1NFQ09ORFNfTEFOR1VBR0V9KTogc3RyaW5nIHtcbiAgICAgICAgaWYgKCFzZWNvbmRzKSB7XG4gICAgICAgICAgICByZXR1cm4gJzAwOjAwOjAwJztcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gL14tP1xcZCsoXFwuXFxkKyk/JC87XG4gICAgICAgIGNvbnN0IGlzTnVtYmVyID0gcmVnZXgudGVzdChTdHJpbmcoc2Vjb25kcykudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIGlmICghaXNOdW1iZXIgfHwgc2Vjb25kcyA8PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gJzAwOjAwOjAwJztcbiAgICAgICAgfSBcblxuICAgICAgICBjb25zdCBkZWZhdWx0T3B0aW9ucyA9IHRoaXMuYml6eUZvcm1hdFNlY29uZHNTZXJ2aWNlLmdldE9wdGlvbnMoKTtcblxuICAgICAgICBjb25zdCBsYW5ndWFnZSA9IG9wdGlvbnM/Lmxhbmd1YWdlID8/IGRlZmF1bHRPcHRpb25zLmxhbmd1YWdlO1xuICAgICAgICBjb25zdCBmb3JtYXQgPSBvcHRpb25zPy5mb3JtYXQgPz8gZGVmYXVsdE9wdGlvbnMuZm9ybWF0O1xuXG4gICAgICAgIGNvbnN0IERBWSA9IGxhbmd1YWdlID09PSBCSVpZX0ZPUk1BVF9TRUNPTkRTX0xBTkdVQUdFLlNQQU5JU0ggPyAnRMOtYScgOiAnRGF5JztcbiAgICAgICAgY29uc3QgREFZUyA9IGxhbmd1YWdlID09PSBCSVpZX0ZPUk1BVF9TRUNPTkRTX0xBTkdVQUdFLlNQQU5JU0ggPyAnRMOtYXMnIDogJ0RheXMnO1xuICAgICAgICBjb25zdCBNT05USCA9IGxhbmd1YWdlID09PSBCSVpZX0ZPUk1BVF9TRUNPTkRTX0xBTkdVQUdFLlNQQU5JU0ggPyAnTWVzJyA6ICdNb250aCc7XG4gICAgICAgIGNvbnN0IE1PTlRIUyA9IGxhbmd1YWdlID09PSBCSVpZX0ZPUk1BVF9TRUNPTkRTX0xBTkdVQUdFLlNQQU5JU0ggPyAnTWVzZXMnIDogJ01vbnRocyc7XG4gICAgICAgIGNvbnN0IFlFQVIgPSBsYW5ndWFnZSA9PT0gQklaWV9GT1JNQVRfU0VDT05EU19MQU5HVUFHRS5TUEFOSVNIID8gJ0HDsW8nIDogJ1llYXInO1xuICAgICAgICBjb25zdCBZRUFSUyA9IGxhbmd1YWdlID09PSBCSVpZX0ZPUk1BVF9TRUNPTkRTX0xBTkdVQUdFLlNQQU5JU0ggPyAnQcOxb3MnIDogJ1llYXJzJztcblxuICAgICAgICBsZXQgX3NlY29uZHMgPSBOdW1iZXIoc2Vjb25kcyk7XG5cbiAgICAgICAgY29uc3QgU0VDT05EU19JTl9ZRUFSID0gMzY1LjI1ICogMjQgKiAzNjAwO1xuICAgICAgICBjb25zdCBTRUNPTkRTX0lOX01PTlRIID0gMzAuNDQgKiAyNCAqIDM2MDA7XG4gICAgICAgIGNvbnN0IFNFQ09ORFNfSU5fREFZID0gMjQgKiAzNjAwO1xuICAgICAgICBjb25zdCBTRUNPTkRTX0lOX0hPVVIgPSAzNjAwO1xuICAgICAgICBjb25zdCBTRUNPTkRTX0lOX01JTlVURSA9IDYwO1xuXG4gICAgICAgIGlmIChmb3JtYXQgPT09IEJJWllfRk9STUFUX1NFQ09ORFNfRk9STUFULkRBVEVfVElNRSkge1xuICAgICAgICAgICAgY29uc3QgeWVhcnMgPSBNYXRoLmZsb29yKF9zZWNvbmRzIC8gU0VDT05EU19JTl9ZRUFSKTtcbiAgICAgICAgICAgIF9zZWNvbmRzICU9IFNFQ09ORFNfSU5fWUVBUjtcbiAgICAgICAgICAgIGNvbnN0IG1vbnRocyA9IE1hdGguZmxvb3IoX3NlY29uZHMgLyBTRUNPTkRTX0lOX01PTlRIKTtcbiAgICAgICAgICAgIF9zZWNvbmRzICU9IFNFQ09ORFNfSU5fTU9OVEg7XG4gICAgICAgICAgICBjb25zdCBkYXlzID0gTWF0aC5mbG9vcihfc2Vjb25kcyAvIFNFQ09ORFNfSU5fREFZKTtcbiAgICAgICAgICAgIF9zZWNvbmRzICU9IFNFQ09ORFNfSU5fREFZO1xuICAgICAgICAgICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKF9zZWNvbmRzIC8gU0VDT05EU19JTl9IT1VSKTtcbiAgICAgICAgICAgIF9zZWNvbmRzICU9IFNFQ09ORFNfSU5fSE9VUjtcbiAgICAgICAgICAgIGNvbnN0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKF9zZWNvbmRzIC8gU0VDT05EU19JTl9NSU5VVEUpO1xuICAgICAgICAgICAgX3NlY29uZHMgJT0gU0VDT05EU19JTl9NSU5VVEU7XG4gICAgXG4gICAgICAgICAgICBjb25zdCBwYXJ0czogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgICAgICAgaWYgKHllYXJzID4gMCkge1xuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goeWVhcnMgKyAoeWVhcnMgPT09IDEgPyBgICR7WUVBUn1gIDogYCAke1lFQVJTfWApKTtcbiAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgIGlmIChtb250aHMgPiAwKSB7XG4gICAgICAgICAgICAgICAgcGFydHMucHVzaChtb250aHMgKyAobW9udGhzID09PSAxID8gYCAke01PTlRIfWAgOiBgICR7TU9OVEhTfWApKTtcbiAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgIGlmIChkYXlzID4gMCkge1xuICAgICAgICAgICAgICAgIHBhcnRzLnB1c2goZGF5cyArIChkYXlzID09PSAxID8gYCAke0RBWX1gIDogYCAke0RBWVN9YCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBwYXJ0cy5wdXNoKGAke2hvdXJzIDwgMTAgPyAnMCcgKyBob3VycyA6IGhvdXJzfToke21pbnV0ZXMgPCAxMCA/ICcwJyArIG1pbnV0ZXMgOiBtaW51dGVzfToke19zZWNvbmRzIDwgMTAgPyAnMCcgKyBNYXRoLnRydW5jKF9zZWNvbmRzKSA6IE1hdGgudHJ1bmMoX3NlY29uZHMpfWApO1xuICAgICAgICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJyAnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcihfc2Vjb25kcyAvIFNFQ09ORFNfSU5fSE9VUik7XG4gICAgICAgICAgICBfc2Vjb25kcyAlPSBTRUNPTkRTX0lOX0hPVVI7XG4gICAgICAgICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihfc2Vjb25kcyAvIFNFQ09ORFNfSU5fTUlOVVRFKTtcbiAgICAgICAgICAgIF9zZWNvbmRzICU9IFNFQ09ORFNfSU5fTUlOVVRFO1xuICAgIFxuICAgICAgICAgICAgY29uc3QgcGFydHM6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgICAgICAgICAgIHBhcnRzLnB1c2goYCR7aG91cnMgPCAxMCA/ICcwJyArIGhvdXJzIDogaG91cnN9OiR7bWludXRlcyA8IDEwID8gJzAnICsgbWludXRlcyA6IG1pbnV0ZXN9OiR7X3NlY29uZHMgPCAxMCA/ICcwJyArIE1hdGgudHJ1bmMoX3NlY29uZHMpIDogTWF0aC50cnVuYyhfc2Vjb25kcyl9YCk7XG4gICAgICAgICAgICByZXR1cm4gcGFydHMuam9pbignICcpO1xuICAgICAgICB9XG4gICAgfVxufVxuIl19